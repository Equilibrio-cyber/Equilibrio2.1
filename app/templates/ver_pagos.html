<!-- app/templates/ver_pagos.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Pagos Registrados</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body class="dashboard">
    <div class="sidebar">
        <ul>
            <li><a href="/logout">ğŸšª Cerrar sesiÃ³n</a></li>
            <li><a href="/dashboard">âŒ›Inicio</a></li>
            <li><a href="/registrar_paciente">ğŸ‘±Registrar Paciente</a></li>
            <li><a href="/visualizar_pacientes">ğŸ”Ver Pacientes</a></li>
            <li><a href="/registrar_pago">ğŸ’³ Registro de Pagos</a></li>
            <li><a href="/ver_pagos">ğŸ” Ver Pagos</a></li>
            <li><a href="/reporte_pagos">ğŸ“Š Reporte Mensual</a></li>
            <li><a href="/registrar_profesional">ğŸ§‘â€âš•ï¸ Profesionales</a></li>
            <li><a href="/ver_profesionales">ğŸ”Ver Profesionales</a></li>
            <li><a href="/seleccionar_paciente_ficha">ğŸ“‹ Ficha ClÃ­nica</a></li>
            <li><a href="{{ url_for('main.ver_ficha_clinica') }}">ğŸ“‹ Ver Ficha ClÃ­nica</a></li>
            <li><a href="{{ url_for('main.registrar_cita') }}">ğŸ“… Registrar Cita</a></li>
            <li><a href="{{ url_for('main.ver_citas') }}">ğŸ“‹ Ver Citas</a></li>
            <li><a href="{{ url_for('main.seleccionar_historial_citas') }}">ğŸ—‚ï¸ Historial de Citas</a></li>
        </ul>
    </div>

    <div class="main-content">
        <h2>ğŸ”Pagos Registrados</h2>
        <table>
            <thead>
                <tr>
                    <th>Paciente</th>
                    <th>Tipo de pago</th>
                    <th>Fecha</th>
                    <th>Respaldo</th>
                    <th>Monto (CLP)</th>
                    <th>Acciones</th>
                    <a href="{{ url_for('main.exportar_pagos_pdf') }}" class="btn">ğŸ“„ Exportar PDF</a>
                    <a href="{{ url_for('main.exportar_pagos_excel') }}" class="btn">ğŸ“Š Exportar Excel</a>

                </tr>
            </thead>
            <tbody>
                {% for pago in pagos %}
                <tr>
                    <td>{{ pago.paciente.nombre }}</td>
                    <td>{{ pago.tipo_pago }}</td>
                    <td>{{ pago.fecha_pago }}</td>
                    <td>
                        {% if pago.respaldo_archivo %}
                            <a href="{{ url_for('main.descargar_respaldo', archivo=pago.respaldo_archivo) }}">ğŸ“ Ver archivo</a>
                        {% else %}
                            âŒ Sin archivo
                        {% endif %}
                    </td>
                    <td>${{ "{:,}".format(pago.monto) }}</td>
                    <td>
                        <a href="{{ url_for('main.editar_pago', id=pago.id) }}" class="btn-editar">âœï¸</a>
                        <form method="POST" action="{{ url_for('main.eliminar_pago', id=pago.id) }}" style="display:inline;">
                            <button type="submit" class="btn-eliminar" onclick="return confirm('Â¿Eliminar este pago?')">ğŸ—‘ï¸</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</body>
</html>
